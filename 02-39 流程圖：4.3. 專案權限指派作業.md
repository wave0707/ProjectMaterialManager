# 流程圖：4.3. 專案權限指派作業

* **文件版本**: 1.0
* **制定日期**: 2025年7月5日
* **制定者**: William He
* **模組**：4. 使用者與權限管理
* **文件狀態**：流程圖語法已更新為 Mermaid。

---

這份流程圖詳細描述了權責人員（如：系統管理員、專案經理）如何將特定的使用者指派到特定的專案中，並賦予其在該專案內的特定角色，以實現細粒度的資料存取控制。

### 流程圖說明

1.  **開始**：流程由管理人員進入「專案權限指派作業」功能頁面開始。
2.  **選擇專案**：管理人員必須先從系統的專案列表中，選擇一個要進行權限指派的專案。
3.  **載入已指派人員**：系統會載入並顯示目前已經被指派到這個專案的所有使用者及其專案角色。
4.  **管理指派**：
    * **新增指派**：
        * 管理人員點擊「新增指派」。
        * 從系統的使用者清單中，搜尋並選擇一位要加入此專案的使用者。
        * 為這位使用者定義他在**這個專案中的特定角色**（例如：監工、現場工程師、採購人員）。
        * 點擊「儲存」。系統會將這筆關聯寫入 `Security.ProjectUserAssignments` 資料表。
    * **修改/移除指派**：
        * 管理人員從已指派的列表中選擇一位使用者。
        * 可以修改他在這個專案中的角色，或直接將他從此專案中移除。
5.  **結束**：專案的權限指派設定完成。

### Mermaid 語法

```mermaid
---
title: 4.3. 專案權限指派作業流程圖
---
flowchart TD
    %% Node Definitions
    subgraph "系統管理員/專案經理"
        A1("開始: 進入<br>專案權限指派功能")
        A2("從列表中選擇一個專案")
        A3{要新增指派？}
        A4("點擊「新增指派」")
        A5("搜尋並選擇一位使用者")
        A6("定義該使用者在此專案中的角色<br>(如：監工、現場工程師)")
        A7("點擊「儲存」")

        A8("從列表中選擇一位使用者")
        A9("修改其專案角色或移除指派")
        A10("點擊「儲存」或「移除」")
    end

    subgraph 系統
        B1("顯示已指派至此專案的<br>使用者列表")
        B2("將指派資料存入<br>Security.ProjectUserAssignments 表")
        B3("更新或刪除<br>Security.ProjectUserAssignments 表的紀錄")
        B4("顯示「設定成功」訊息")
    end
    
    %% Link Definitions
    A1 --> A2 --> B1 --> A3
    
    %% Add Assignment Path
    A3 -- "是" --> A4 --> A5 --> A6 --> A7 --> B2
    
    %% Modify/Remove Assignment Path
    A3 -- "否，修改/移除現有指派" --> A8 --> A9 --> A10 --> B3

    B2 --> B4
    B3 --> B4
    B4 --> Z(結束)