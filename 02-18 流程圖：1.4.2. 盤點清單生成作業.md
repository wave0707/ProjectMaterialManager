# 流程圖：1.4.2. 盤點清單生成作業

* **文件版本**: 1.0
* **制定日期**: 2025年7月5日
* **制定者**: William He
* **模組**：1.4. 庫存盤點
* **文件狀態**：流程圖語法已更新為 Mermaid。

---

這份流程圖詳細描述了倉管主管根據已建立的盤點計畫，生成一份供盤點人員實際使用的盤點清單（或稱盤點單）的操作步驟。

### 流程圖說明

1.  **開始**：流程由倉管主管進入「盤點清單生成作業」功能頁面開始。
2.  **選擇盤點計畫**：
    * 系統會列出所有狀態為「計畫中」的盤點計畫。
    * 主管從列表中選擇一個準備執行的計畫。
3.  **生成清單**：
    * 主管點擊「生成盤點清單」或「列印」按鈕。
4.  **系統處理與產出**：
    * 系統會根據所選計畫的明細 (`Inventory.CountPlanLines`)，撈取所有需要盤點的項目。
    * 系統產出一份格式化的盤點清單。這份清單應包含「儲位」、「物料編號」、「物料名稱」、「批號」等資訊，以及一個**空白欄位**供盤點人員填寫「實際盤點數量」。
    * **(重要)**：為了確保盤點的準確性（稱為「盲盤」），這份清單上**不應該**顯示系統的帳面庫存數量，避免盤點人員受到預期數字的影響。
    * 系統在生成清單後，會將該盤點計畫的 `Status` (狀態) 更新為「執行中」，表示盤點工作已經開始。
5.  **結束**：盤點人員取得盤點清單（紙本或在行動裝置上顯示），可以開始進行實體的盤點作業。

### Mermaid 語法

```mermaid
---
title: 1.4.2. 盤點清單生成作業流程圖
---
flowchart TD
    %% Node Definitions
    subgraph 倉管主管
        A1("開始: 進入<br>盤點清單生成作業")
        A2("從列表中選擇<br>一筆盤點計畫")
        A3("點擊「生成盤點清單」")
    end

    subgraph 系統
        B1("顯示所有狀態為「計畫中」<br>的盤點計畫")
        B2("根據計畫明細 (`Inventory.CountPlanLines`)<br>撈取需盤點的項目")
        B3("生成盤點清單<br>(可列印/匯出)")
        B4("更新盤點計畫狀態<br>為「執行中」")
        B5("顯示「盤點清單生成成功」訊息")
    end

    subgraph 盤點人員
        C1("接收盤點清單，<br>開始實體盤點")
    end
    
    subgraph Note1 [重要說明]
        N1["為求準確，盤點清單上<br>不應顯示「系統帳面數量」。<br>僅留白欄位供盤點人員填寫。"]
    end

    %% Link Definitions
    A1 --> B1
    B1 --> A2
    A2 --> A3
    A3 --> B2
    B2 --> B3
    B3 --> B4
    B4 --> B5
    B5 --> C1
    C1 --> Z(結束)

    B3 -.-> Note1
    style Note1 fill:#lightyellow,stroke:#333,stroke-dasharray: 5 5