# 流程圖：1.2.1. 專案領料申請作業

* **文件版本**: 1.0
* **制定日期**: 2025年7月5日
* **制定者**: William He
* **模組**：1.2. 出庫管理
* **文件狀態**：流程圖語法已更新為 Mermaid。

---

這份流程圖詳細描述了案場的工程師或相關人員，因施工需要，在系統中提出物料領用申請的完整操作步驟。

### 流程圖說明

1.  **開始**：流程由案場人員（如：現場工程師）進入「專案領料申請作業」功能頁面開始。
2.  **建立申請單**：
    * 案場人員點擊「新增申請」按鈕。
    * 系統會要求使用者先選擇要申請物料的「專案」及「案場」。
3.  **填寫申請內容**：
    * 案場人員接著填寫表頭資訊，如「需求日期」。
    * 接著，逐一新增需要領用的物料明細，包含選擇「物料」及填寫「申請數量」。
    * **(系統輔助)**：在選擇物料時，系統可以智能地顯示該專案的「物料清單 (`Project.BOMs`)」或「目前可用庫存」，幫助使用者快速且準確地提出申請。
4.  **提交申請**：
    * 確認所有申請項目無誤後，案場人員點擊「提交審核」。
5.  **系統處理**：
    * 系統會先驗證資料的完整性。
    * 驗證通過後，系統會：
        * 自動產生一組唯一的「領料申請單號 (`RequisitionNumber`)」。
        * 將申請資料存入 `Inventory.MaterialRequisitionHeaders` 與 `Inventory.MaterialRequisitionLines` 資料表。
        * 將該筆申請單的 `ApprovalStatus` (審核狀態) 設為「待審核」。
        * (可選) 發送通知給指定的審核人員（如：專案經理）。
6.  **結束**：申請單成功送出，等待後續的「1.2.2. 領料申請審核作業」。

### Mermaid 語法

```mermaid
---
title: 1.2.1. 專案領料申請作業流程圖
---
flowchart TD
    subgraph 案場人員
        A1("開始: 進入<br>專案領料申請作業") --> A2("點擊「新增申請」") --> B1
        B1 --> A3("選擇對應的專案與案場") --> A4("填寫表頭資訊<br>(如：需求日期)") --> A5("新增物料明細")
        A5 --> A6("選擇物料並<br>填寫申請數量") --> A7("點擊「提交審核」") --> B3
    end

    subgraph 系統
        B1("要求選擇「專案」與「案場」")
        B3{資料驗證成功？}
        B4("產生領料申請單號") --> B5("儲存申請單資料<br>(狀態: 待審核)") --> B6("發送通知給審核人員") --> B7("顯示「提交成功」訊息")
        B8("顯示錯誤訊息")
    end
    
    subgraph Note1 [輔助資訊]
        N1["系統可輔助顯示<br>· 專案BOM (Project.BOMs)<br>· 專案可用庫存"]
    end
    
    A5 -.-> Note1
    style Note1 fill:#lightyellow,stroke:#333,stroke-dasharray: 5 5

    B3 -- "是" --> B4
    B3 -- "否" --> B8

    B7 --> Z(結束)
    B8 --> A1