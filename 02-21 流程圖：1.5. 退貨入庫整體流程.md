# 流程圖：1.5. 退貨入庫整體流程

* **文件版本**: 1.0
* **制定日期**: 2025年7月5日
* **制定者**: William He
* **模組**：1. 物料管理核心流程
* **文件狀態**：流程圖語法已更新為 Mermaid。

---

這份流程圖從一個更高的視角，展示了物料從案場提出退料申請、審核到最終由倉庫接收並加回庫存的完整生命週期，並將先前定義的核心作業串聯起來。

### 流程圖說明

1.  **開始 (提出申請)**：流程由案場人員根據實際情況（如：工程剩料），執行「1.5.1. 專案退料申請作業」，在系統中建立一張狀態為「待接收」或「待審核」的退料單。
2.  **審核 (可選)**：若流程需要，權責主管會接著執行「1.5.2. 退料申請審核作業」，對該申請單進行審核。
3.  **審核判斷**：
    * 若申請被駁回：流程結束，原申請人會收到駁回通知。
    * 若申請被核准 (或流程無需審核)：流程繼續往下，系統會通知倉管人員準備接收退料。
4.  **接收退料 (庫存異動)**：倉庫管理人員在收到實體退料後，執行「1.5.3. 退料接收作業」。此步驟會點收物料，並在系統上進行最終的接收確認，**正式將物料加回系統庫存**。
5.  **結束**：退回的物料成功入庫，流程結束。

*(註：1.5.4. 退料記錄查詢作業是一個獨立的查詢功能，可以在任何時間點執行，因此未包含在此核心交易流程中。)*

### Mermaid 語法

```mermaid
---
title: 1.5. 退貨入庫整體流程圖
---
flowchart TD
    %% Node Definitions
    subgraph 案場人員
        A1("開始: 執行「1.5.1. 專案退料申請作業」<br>建立退料單")
    end

    subgraph 系統流程判斷
        B1{流程是否<br>需要審核？}
    end

    subgraph 審核人員
        C1("執行「1.5.2. 退料申請審核作業」")
        C2{審核結果？}
        F1("接收駁回通知")
        F2("結束此申請流程")
    end
    
    subgraph 倉庫管理人員
        D1("執行「1.5.3. 退料接收作業」")
    end

    subgraph 系統
        E1("物料正式加回庫存")
    end
    
    subgraph Note1 [異動說明]
        N1["此步驟將正式異動庫存：<br>· 建立「退料入庫」紀錄<br>· 更新庫存數量"]
    end

    %% Link Definitions
    A1 --> B1
    
    B1 -- "是" --> C1
    C1 --> C2
    C2 -- "核准" --> D1
    C2 -- "駁回" --> F1 --> F2 --> Z(結束)
    
    B1 -- "否" --> D1
    
    D1 --> E1
    E1 --> Z
    
    D1 -.-> Note1
    style Note1 fill:#lightyellow,stroke:#333,stroke-dasharray: 5 5