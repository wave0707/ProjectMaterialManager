# 流程圖：4.2. 角色與權限設定作業

* **文件版本**: 1.0
* **制定日期**: 2025年7月5日
* **制定者**: William He
* **模組**：4. 使用者與權限管理
* **文件狀態**：流程圖語法已更新為 Mermaid。

---

這份流程圖詳細描述了系統管理員如何定義系統中的「角色」（如：專案經理、倉管人員），並為這些角色配置其所能執行的「權限」（如：新增物料、審核領料單）的完整操作步驟。

### 流程圖說明

1.  **開始**：流程由系統管理員進入「角色與權限設定作業」功能頁面開始。
2.  **管理角色**：
    * 管理員可以新增、修改或刪除一個「角色」。例如，新增一個名為「現場監工」的角色。
3.  **選擇角色進行權限配置**：
    * 管理員從角色列表中選擇一個要設定權限的角色（例如，選擇剛建立的「現場監工」）。
4.  **配置權限**：
    * 系統會顯示所有可用的「權限」清單（`Security.Permissions` 表中的所有項目，如 `material.view`, `requisition.create` 等）。
    * 管理員從權限清單中，勾選所有希望賦予該角色的權限。
5.  **儲存設定**：
    * 管理員點擊「儲存」按鈕。
    * 系統會將該「角色」與其對應的所有「權限」的關聯關係，寫入 `Security.RolePermissions` 關聯表中。
6.  **結束**：角色的權限配置完成。後續在「使用者帳戶管理」中，只要將使用者指派給此角色，該使用者就自動擁有了這些權限。

*(註：系統中的「權限」(Permissions) 通常由開發人員預先定義在資料庫中，此作業主要是管理「角色」以及「角色與權限的關聯」。)*

### Mermaid 語法

```mermaid
---
title: 4.2. 角色與權限設定作業流程圖
---
flowchart TD
    %% Node Definitions
    subgraph 系統管理員
        A1("開始: 進入<br>角色與權限設定功能")
        A2("新增/修改/刪除「角色」")
        A3("從角色列表中<br>選擇一個角色")
        A4("從權限列表中勾選<br>要賦予該角色的權限")
        A5("點擊「儲存」")
    end

    subgraph 系統
        B1("顯示系統中所有可用的<br>「權限」列表 (from `Security.Permissions`)")
        B2("將「角色」與「權限」的對應關係<br>存入 `Security.RolePermissions` 關聯表")
        B3("顯示「設定成功」訊息")
    end
    
    subgraph Note1 [說明]
        N1["例如：建立一個名為<br>「現場監工」的角色"]
    end
    
    %% Link Definitions
    A1 --> A2
    A2 --> A3
    A3 --> B1
    B1 --> A4
    A4 --> A5
    A5 --> B2
    B2 --> B3
    B3 --> Z(結束)
    
    A2 -.-> Note1
    style Note1 fill:#lightyellow,stroke:#333,stroke-dasharray: 5 5